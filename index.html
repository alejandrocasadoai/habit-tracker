<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>Habit Tracker Minimalista para Notion</title>
  <style>
    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen,
        Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif;
      background: transparent;
      margin: 0;
      padding: 0 10px;
      color: #333;
    }
    .tracker {
      max-width: 100%;
      overflow-x: auto;
      background: transparent;
      padding: 0;
      margin: 0 auto;
    }
    h1 {
      font-weight: 600;
      font-size: 1.4rem;
      margin-bottom: 10px;
      color: #111;
    }
    .controls {
      display: flex;
      justify-content: space-between;
      align-items: center;
      margin-bottom: 8px;
      flex-wrap: wrap;
      gap: 6px;
    }
    select, button {
      background: #f5f5f5;
      border: 1px solid #ddd;
      border-radius: 4px;
      padding: 6px 10px;
      font-size: 0.9rem;
      cursor: pointer;
      color: #111;
      transition: background 0.15s ease;
    }
    select:hover, button:hover {
      background: #eaeaea;
    }
    table {
      border-collapse: collapse;
      width: 100%;
      min-width: 700px;
    }
    th, td {
      border: 1px solid #ddd;
      padding: 4px 8px;
      text-align: center;
      font-size: 0.85rem;
    }
    th {
      background: #fafafa;
      font-weight: 600;
      position: sticky;
      top: 0;
      z-index: 2;
      color: #555;
    }
    input.habit-name {
      border: none;
      background: transparent;
      font-weight: 600;
      width: 100%;
      text-align: left;
      font-size: 0.9rem;
      padding: 2px 0;
      color: #111;
      cursor: text;
    }
    input.habit-name:focus {
      outline: 1px solid #bbb;
      background: #fff;
    }
    input[type="checkbox"] {
      transform: scale(1.1);
      cursor: pointer;
    }

    /* Botón borrar aparece sólo al hover sobre la celda del nombre */
    td:first-child {
      position: relative;
      padding-right: 28px;
    }
    .delete-btn {
      position: absolute;
      right: 6px;
      top: 50%;
      transform: translateY(-50%);
      background: transparent;
      border: none;
      color: #888;
      font-weight: 700;
      font-size: 1rem;
      cursor: pointer;
      opacity: 0;
      transition: opacity 0.15s ease;
      padding: 0;
      line-height: 1;
      user-select: none;
    }
    tr:hover td:first-child .delete-btn {
      opacity: 1;
    }
    .delete-btn:hover {
      color: #e03e3e;
    }
  </style>
</head>
<body>

  <div class="tracker">
    <h1>Habit Tracker</h1>
    <div class="controls">
      <div>
        <label for="month">Mes:</label>
        <select id="month" onchange="renderTable()"></select>
        <button onclick="clearMonth()">Borrar Todo</button>
      </div>
      <button onclick="addHabit()">➕ Añadir Hábito</button>
    </div>
    <table>
      <thead id="thead"></thead>
      <tbody id="tbody"></tbody>
    </table>
  </div>

<script>
  // Datos iniciales para demo (puedes cargar de tu backend o Firestore)
  const months = [
    'Enero','Febrero','Marzo','Abril','Mayo','Junio',
    'Julio','Agosto','Septiembre','Octubre','Noviembre','Diciembre'
  ];
  const daysInMonth = {
    Enero: 31, Febrero: 28, Marzo: 31, Abril: 30, Mayo: 31, Junio: 30,
    Julio: 31, Agosto: 31, Septiembre: 30, Octubre: 31, Noviembre: 30, Diciembre: 31
  };

  let data = {};
  months.forEach(m => data[m] = []);
  // Para demo inicial, puedes añadir un hábito base
  data['Enero'].push({name:'Beber agua', days: new Array(daysInMonth['Enero']).fill(false)});

  const monthSelect = document.getElementById('month');
  const thead = document.getElementById('thead');
  const tbody = document.getElementById('tbody');

  // Rellenar select meses
  months.forEach(m => {
    const opt = document.createElement('option');
    opt.value = m;
    opt.textContent = m;
    monthSelect.appendChild(opt);
  });
  // Seleccionamos el mes actual por defecto
  const now = new Date();
  monthSelect.value = months[now.getMonth()];

  function renderTable() {
    const month = monthSelect.value;
    if (!data[month]) data[month] = [];
    const days = daysInMonth[month];

    // Cabezera
    let headRow = '<tr><th>Hábito</th>';
    for (let i = 1; i <= days; i++) headRow += `<th>${i}</th>`;
    headRow += `<th>%</th></tr>`;
    thead.innerHTML = headRow;

    // Cuerpo
    tbody.innerHTML = data[month].map((habit, i) => {
      const checks = habit.days.map((checked, day) =>
        `<td><input type="checkbox" ${checked ? 'checked' : ''} onchange="toggleDay(${i},${day})"></td>`
      ).join('');
      const total = habit.days.length;
      const done = habit.days.filter(Boolean).length;
      const percent = total ? Math.round(done * 100 / total) : 0;

      return `<tr>
        <td>
          <input class="habit-name" value="${habit.name}" onchange="renameHabit(${i}, this.value)" />
          <button class="delete-btn" onclick="deleteHabit(${i})" title="Borrar hábito">✕</button>
        </td>
        ${checks}
        <td>${percent}%</td>
      </tr>`;
    }).join('');
  }

  function addHabit() {
    const month = monthSelect.value;
    if (!data[month]) data[month] = [];
    const days = daysInMonth[month];
    data[month].push({name:'Nuevo hábito', days: new Array(days).fill(false)});
    renderTable();
  }

  function renameHabit(i, newName) {
    const month = monthSelect.value;
    if (!data[month]) return;
    data[month][i].name = newName;
    renderTable();
  }

  function toggleDay(i, day) {
    const month = monthSelect.value;
    if (!data[month]) return;
    data[month][i].days[day] = !data[month][i].days[day];
    renderTable();
  }

  function deleteHabit(i) {
    const month = monthSelect.value;
    if (!data[month]) return;
    data[month].splice(i, 1);
    renderTable();
  }

  function clearMonth() {
    const month = monthSelect.value;
    if (!data[month]) return;
    data[month].forEach(habit => habit.days.fill(false));
    renderTable();
  }

  // Render inicial
  renderTable();
</script>

</body>
</html>


